<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation of HyperQueue."><meta name=author content="Ada Böhm, Jakub Beránek"><link href=https://it4innovations.github.io/hyperqueue/stable/jobs/resources/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-7.3.2"><title>Resources - HyperQueue</title><link rel=stylesheet href=../../assets/stylesheets/main.24c991ad.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-TM8J8R5GJ9"),document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof location$&&location$.subscribe(function(t){gtag("config","G-TM8J8R5GJ9",{page_path:t.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-TM8J8R5GJ9"></script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=none data-md-color-accent=none> <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#resource-management class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=HyperQueue class="md-header__button md-logo" aria-label=HyperQueue data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> HyperQueue </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Resources </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/It4innovations/hyperqueue/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=HyperQueue class="md-nav__button md-logo" aria-label=HyperQueue data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> HyperQueue </label> <div class=md-nav__source> <a href=https://github.com/It4innovations/hyperqueue/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../installation/ class=md-nav__link> Installation </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Getting Started <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting Started" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../quickstart/ class=md-nav__link> Quickstart </a> </li> <li class=md-nav__item> <a href=../../cheatsheet/ class=md-nav__link> Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Examples <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Examples data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/ class=md-nav__link> Examples </a> </li> <li class=md-nav__item> <a href=../../examples/iterative-computation/ class=md-nav__link> Iterative computation </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Deployment <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Deployment data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../deployment/ class=md-nav__link> Architecture </a> </li> <li class=md-nav__item> <a href=../../deployment/server/ class=md-nav__link> Server </a> </li> <li class=md-nav__item> <a href=../../deployment/worker/ class=md-nav__link> Workers </a> </li> <li class=md-nav__item> <a href=../../deployment/allocation/ class=md-nav__link> Automatic Allocation </a> </li> <li class=md-nav__item> <a href=../../deployment/cloud/ class=md-nav__link> Without Shared Filesystem </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6> Task computation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Task computation" data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Task computation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../jobs/ class=md-nav__link> Jobs and Tasks </a> </li> <li class=md-nav__item> <a href=../arrays/ class=md-nav__link> Task Arrays </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Resources <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Resources </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#resource-management class=md-nav__link> Resource management </a> </li> <li class=md-nav__item> <a href=#worker-resources class=md-nav__link> Worker resources </a> <nav class=md-nav aria-label="Worker resources"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#specifying-worker-resources class=md-nav__link> Specifying worker resources </a> </li> <li class=md-nav__item> <a href=#resource-names class=md-nav__link> Resource names </a> </li> <li class=md-nav__item> <a href=#automatically-detected-resources class=md-nav__link> Automatically detected resources </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#resource-request class=md-nav__link> Resource request </a> </li> <li class=md-nav__item> <a href=#requesting-all-resources class=md-nav__link> Requesting all resources </a> </li> <li class=md-nav__item> <a href=#resource-request-strategies class=md-nav__link> Resource request strategies </a> <nav class=md-nav aria-label="Resource request strategies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#non-integer-allocation-of-resources class=md-nav__link> Non-integer allocation of resources </a> </li> <li class=md-nav__item> <a href=#resource-environment-variables class=md-nav__link> Resource environment variables </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#resource-requests-and-job-arrays class=md-nav__link> Resource requests and job arrays </a> </li> <li class=md-nav__item> <a href=#resource-variants class=md-nav__link> Resource variants </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../cresources/ class=md-nav__link> CPU Resources </a> </li> <li class=md-nav__item> <a href=../failure/ class=md-nav__link> Handling Failure </a> </li> <li class=md-nav__item> <a href=../streaming/ class=md-nav__link> Output Streaming </a> </li> <li class=md-nav__item> <a href=../directives/ class=md-nav__link> Directives </a> </li> <li class=md-nav__item> <a href=../jobfile/ class=md-nav__link> Job Definition File </a> </li> <li class=md-nav__item> <a href=../multinode/ class=md-nav__link> Multinode Tasks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> CLI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=CLI data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> CLI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/shortcuts/ class=md-nav__link> Shortcuts </a> </li> <li class=md-nav__item> <a href=../../cli/output-mode/ class=md-nav__link> Output mode </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8> Python API <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Python API" data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Python API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../python/ class=md-nav__link> Getting started </a> </li> <li class=md-nav__item> <a href=../../python/client/ class=md-nav__link> Client </a> </li> <li class=md-nav__item> <a href=../../python/submit/ class=md-nav__link> Submitting jobs </a> </li> <li class=md-nav__item> <a href=../../python/dependencies/ class=md-nav__link> Dependencies </a> </li> <li class=md-nav__item> <a href=../../python/apidoc/ class=md-nav__link> API reference </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../events/ class=md-nav__link> Events </a> </li> <li class=md-nav__item> <a href=../../faq/ class=md-nav__link> FAQ </a> </li> <li class=md-nav__item> <a href=../../other-tools/ class=md-nav__link> Comparison With Other Tools </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#resource-management class=md-nav__link> Resource management </a> </li> <li class=md-nav__item> <a href=#worker-resources class=md-nav__link> Worker resources </a> <nav class=md-nav aria-label="Worker resources"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#specifying-worker-resources class=md-nav__link> Specifying worker resources </a> </li> <li class=md-nav__item> <a href=#resource-names class=md-nav__link> Resource names </a> </li> <li class=md-nav__item> <a href=#automatically-detected-resources class=md-nav__link> Automatically detected resources </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#resource-request class=md-nav__link> Resource request </a> </li> <li class=md-nav__item> <a href=#requesting-all-resources class=md-nav__link> Requesting all resources </a> </li> <li class=md-nav__item> <a href=#resource-request-strategies class=md-nav__link> Resource request strategies </a> <nav class=md-nav aria-label="Resource request strategies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#non-integer-allocation-of-resources class=md-nav__link> Non-integer allocation of resources </a> </li> <li class=md-nav__item> <a href=#resource-environment-variables class=md-nav__link> Resource environment variables </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#resource-requests-and-job-arrays class=md-nav__link> Resource requests and job arrays </a> </li> <li class=md-nav__item> <a href=#resource-variants class=md-nav__link> Resource variants </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/It4innovations/hyperqueue/blob/main/docs/jobs/resources.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1>Resources</h1> <h2 id=resource-management>Resource management<a class=headerlink href=#resource-management title="Permanent link">#</a></h2> <p>Resource management serves for defining arbitrary resources provided by workers and also corresponding <strong>resource requests</strong> required by tasks. HyperQueue will take care of matching task resource requests so that only workers that can fulfill them will be able to execute such tasks.</p> <p>Some generic resources are <a href=#automatically-detected-resources>automatically detected</a>; however, users may also define their own resources.</p> <p>From version 0.13.0, CPUs are also managed as other resources, but they have still some extra functionality; therefore, there is a special section about <a href=../cresources/ >CPU resources</a>. </p> <div class="admonition important"> <p class=admonition-title>Important</p> <p>Resources in HyperQueue exist on a purely logical level. They can correspond to physical things (like GPUs), but it is the responsibility of the user to make sure that this correspondence makes sense. With exception of CPUs, HyperQueue by itself does not attach any semantics to resources, they are just numbers used for scheduling.</p> </div> <h2 id=worker-resources>Worker resources<a class=headerlink href=#worker-resources title="Permanent link">#</a></h2> <p>Each worker has one or mores resources attached. Each resource is a <strong>resource pool</strong> identified by a name. A resource pool represents some resources provided by a worker; each task can then ask for a part of the resources contained in that pool.</p> <p>There are two kinds of resource pools:</p> <ul> <li> <p><strong>Indexed pool</strong>: This pool represents an enumerated set of resources represented by strings. Each resource has its own identity. Tasks do not ask for specific values from the set, they just specify how many resources they require and HyperQueue will allocate the specified amount of resources from the pool for each task.</p> <p>This pool is useful for resources that have their own identity, for example individual GPU or FPGA accelerators.</p> <p>HyperQueue guarantees that no individual resource from the indexed pool is allocated to more than a single task at any given time and that a task will not be executed on a worker if it does not currently have enough individual resources to fulfill the <a href=#resource-request>resource request</a> of the task.</p> <p>Indexed pool can be defined with <strong>groups</strong> where indices live in separated groups. Task may then ask for different allocation policies (e.g. use resources from the same or different groups). The main purpose of this is to capture NUMA architectures, each group then represents a socket with cores.</p> </li> <li> <p><strong>Sum pool</strong>: This pool represents a resource that has a certain size which is split into individual tasks. A typical example is memory; if a worker has <code>2000</code> bytes of memory, it can serve e.g. four tasks, if each task asks for <code>500</code> bytes of memory.</p> <p>HyperQueue guarantees that the sum of resource request sizes of <em>running</em> tasks on a worker does not exceed the total size of the sum pool.</p> </li> </ul> <h3 id=specifying-worker-resources>Specifying worker resources<a class=headerlink href=#specifying-worker-resources title="Permanent link">#</a></h3> <p>You can specify the resource pools of a worker when you start it:</p> <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>worker<span class=w> </span>start<span class=w> </span>--resource<span class=w> </span><span class=s2>&quot;&lt;NAME1&gt;=&lt;DEF1&gt;&quot;</span><span class=w> </span>--resource<span class=w> </span><span class=s2>&quot;&lt;NAME2&gt;=&lt;DEF2&gt;&quot;</span><span class=w> </span>...
</code></pre></div> <p>where <code>NAMEi</code> is a name (string ) of the <code>i</code>-th resource pool and <code>DEFi</code> is a definition of the <code>i-th</code> resource pool. You can define resource pools using one of the following formats:</p> <ul> <li><code>[&lt;VALUE&gt;, &lt;VALUE&gt;, ..., &lt;VALUE&gt;]</code> where <code>VALUE</code> is a string. This defines a an indexed pool with the given values. If you need to enter a string resource that contains special characters (<code>[</code>, <code>]</code>, <code>,</code>, whitespace), you can wrap the value in quotes: <code>["foo [,]", bar, "my resource"]</code>.</li> <li><code>range(&lt;START&gt;-&lt;END&gt;)</code> where <code>START</code> and <code>END</code> are non-negative integers. This defines an indexed pool with numbers in the inclusive range <code>[START, END]</code>.</li> <li><code>[[&lt;VALUE&gt;, ..., &lt;VALUE&gt;], [&lt;VALUE&gt;, ..., &lt;VALUE&gt;], ...]</code> where <code>VALUE</code> is a string. This defines an indexed pool where indices are grouped.</li> <li><code>&lt;N&gt;x&lt;M&gt;</code> Creates indexed pool with N groups of size M, indices are indexed from 0, (e.g. "2x3" is equivalent to <code>[[0, 1, 2], [3, 4, 5]</code>)</li> <li><code>sum(&lt;SIZE&gt;)</code> where <code>SIZE</code> is a positive integer. This defines a sum pool with the given size.</li> </ul> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>You might encounter a problem in your shell when you try to specify worker resources, because the definition contains parentheses (<code>()</code>). In that case just wrap the resource definition in quotes, like this:</p> <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>worker<span class=w> </span>start<span class=w> </span>--resource<span class=w> </span><span class=s2>&quot;foo=sum(5)&quot;</span>
</code></pre></div> </div> <h3 id=resource-names>Resource names<a class=headerlink href=#resource-names title="Permanent link">#</a></h3> <p>Resource names are restricted by the following rules:</p> <ul> <li>They can only contain ASCII letters and digits (<code>a-z</code>, <code>A-Z</code>, <code>0-9</code>) and the slash (<code>/</code>) symbol.</li> <li>They need to begin with an ASCII letter.</li> </ul> <p>These restrictions exist because the resource names are passed as environment variable names to tasks, which often execute shell scripts. However, shells typically do not support environment variables containing anything else than ASCII letters, digits and the underscore symbol. Therefore, HQ limits resource naming to align with the behaviour of the shell.</p> <div class="admonition important"> <p class=admonition-title>Important</p> <p>HQ will normalize the resource name when passing environment variables to a task (see <a href=#resource-environment-variables>below</a>).</p> </div> <h3 id=automatically-detected-resources>Automatically detected resources<a class=headerlink href=#automatically-detected-resources title="Permanent link">#</a></h3> <p>The following resources are detected automatically if a resource of a given name is not explicitly defined.</p> <ul> <li> <p>CPUs are automatically detected as resource named "cpus" (more in <a href=../cresources/ >CPU resources</a>).</p> </li> <li> <p>GPUs that are available when a worker is started are automatically detected under the following resource names:</p> <ul> <li>NVIDIA GPUs are stored the under resource name <code>gpus/nvidia</code>. These GPUs are detected from the environment variable <code>CUDA_VISIBLE_DEVICES</code> or from the <code>procfs</code> filesystem.</li> <li>AMD GPUs are stored under the resource name <code>gpus/amd</code>. These GPUs are detected from the environment variable <code>ROCR_VISIBLE_DEVICES</code>.</li> </ul> <p>You can set these environment variables when starting a worker to override the list of available GPUs:</p> <div class=highlight><pre><span></span><code>$<span class=w> </span><span class=nv>CUDA_VISIBLE_DEVICES</span><span class=o>=</span><span class=m>2</span>,3<span class=w> </span>hq<span class=w> </span>worker<span class=w> </span>start
<span class=c1># The worker will have resource gpus/nvidia=[2,3]</span>
</code></pre></div> </li> <li> <p>RAM of the node is detected as resource "mem" in megabytes; i.e. <code>--resource mem=100</code> asks for 100 MiBs of the memory.</p> </li> </ul> <p>If you want to see how is your system seen by a worker without actually starting it, you can start: </p> <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>worker<span class=w> </span>hwdetect
</code></pre></div> <p>The automatic detection of resources can be disabled by argument <code>--no-detect-resources</code> in <code>hq worker start ...</code>. It disables detection of resources other than "cpus"; if resource "cpus" are not explicitly defined, it will always be detected.</p> <h2 id=resource-request>Resource request<a class=headerlink href=#resource-request title="Permanent link">#</a></h2> <p>When you submit a job, you can define a <strong>resource requests</strong> with the <code>--resource</code> flag:</p> <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>submit<span class=w> </span>--resource<span class=w> </span>&lt;NAME1&gt;<span class=o>=</span>&lt;AMOUNT1&gt;<span class=w> </span>--resource<span class=w> </span>&lt;NAME2&gt;<span class=o>=</span>&lt;AMOUNT2&gt;<span class=w> </span>...
</code></pre></div> <p>Where <code>NAME</code> is a name of the requested resource and the <code>AMOUNT</code> is a positive number defining the size of the request.</p> <p>Tasks with such resource requests will only be executed on workers that fulfill all the specified task requests.</p> <div class="admonition important"> <p class=admonition-title>Important</p> <p>Notice that task resource requests always ask for an amount of resources required by a task, regardless whether that resource corresponds to an indexed or a sum pool on workers.</p> <p>For example, let's say that a worker has an indexed pool of GPUs: <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>worker<span class=w> </span>start<span class=w> </span>--resource<span class=w> </span><span class=s2>&quot;gpus/nvidia=range(1-3)&quot;</span>
</code></pre></div> And we create two jobs, each with a single task. The first job wants 1 GPU, the second one wants two GPUs.</p> <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>submit<span class=w> </span>--resource<span class=w> </span>gpus/nvidia<span class=o>=</span><span class=m>1</span><span class=w> </span>...
$<span class=w> </span>hq<span class=w> </span>submit<span class=w> </span>--resource<span class=w> </span>gpus/nvidia<span class=o>=</span><span class=m>2</span><span class=w> </span>...
</code></pre></div> <p>Then the first job can be allocated e.g. the GPU <code>2</code> and the second job can be allocated the GPUs <code>1</code> and <code>3</code>. </p> </div> <h2 id=requesting-all-resources>Requesting all resources<a class=headerlink href=#requesting-all-resources title="Permanent link">#</a></h2> <p>A task may ask for all given resources of that type by specifying <code>--resource &lt;NAME&gt;=all</code>. Such a task will be scheduled only on a worker that has at least <code>1</code> of such resource and when a task is executed all resources of that type will be given to this task. </p> <h2 id=resource-request-strategies>Resource request strategies<a class=headerlink href=#resource-request-strategies title="Permanent link">#</a></h2> <p>When resource request is defined, after the amount you can define allocation strategy: <code>--resource &lt;NAME&gt;="&lt;AMOUNT&gt; &lt;STRATEGY&gt;"</code>.</p> <p>Specifying strategy has effect only if worker provides indexed resource in groups. If resource is other type, then strategy is ignored.</p> <p>When strategy is not defined then <code>compact</code> is used as default.</p> <ul> <li> <p>Compact (<code>compact</code>) - Tries to allocate indices in few groups as possible in the current worker state.</p> <p>Example: <div class=highlight><pre><span></span><code><span class=gp>$ </span>hq<span class=w> </span>submit<span class=w> </span>--resource<span class=w> </span><span class=nv>cpus</span><span class=o>=</span><span class=s2>&quot;8 compact&quot;</span><span class=w> </span>...
</code></pre></div></p> </li> <li> <p>Strict Compact (<code>compact!</code>) - Always allocate indices on as few groups as possible for a target node. The task is not executed until the requirement could not be fully fulfilled. E.g. If a worker has 4 indices per a group and you ask for 4 indices in the strict compact mode, it will always be executed with indices from a single group. If you ask for 8 cpus in the same way, it will always be executed with indices from two groups.</p> <p>Example: <div class=highlight><pre><span></span><code><span class=gp>$ </span>hq<span class=w> </span>submit<span class=w> </span>--resource<span class=w> </span><span class=nv>cpus</span><span class=o>=</span><span class=s2>&quot;8 compact!&quot;</span><span class=w> </span>...<span class=sb>`</span>
</code></pre></div></p> </li> <li> <p>Scatter (<code>scatter</code>) - Allocate indices across as many groups as possible in the current worker state. E.g. Let us assume that a worker has 4 groups with 8 indices per group, and you ask for 8 cpus in the scatter mode. If possible in the current situation, HQ tries to run process with 2 cpus on each socket.</p> <p>Example: <div class=highlight><pre><span></span><code><span class=gp>$ </span>hq<span class=w> </span>submit<span class=w> </span>--resource<span class=w> </span><span class=nv>cpus</span><span class=o>=</span><span class=s2>&quot;8 scatter&quot;</span><span class=w> </span>...
</code></pre></div></p> </li> </ul> <h3 id=non-integer-allocation-of-resources>Non-integer allocation of resources<a class=headerlink href=#non-integer-allocation-of-resources title="Permanent link">#</a></h3> <p>Amount of the resource may be a non-integer number. E.g. you may ask for 0.5 of a resource. It tells the scheduler that you want to utilize only half of the resource and if another process asks for at most 0.5 of the resource, it may get the same resource. This resource sharing is done on logical of HyperQueue and actual resource sharing is up to tasks.</p> <p>The precision for defining amount is four decimal places. Therefore, the minimal resource amount that you can ask for is <code>0.0001</code>.</p> <p>For sum resources, the amount is simply removed from the pool as in the case of integer resources.</p> <p>In the case of an indexed resource, the partial resource is always taken from a single index. It means that if there is an indexed resource with two indices that are both utilized on 0.75, then a task that ask for 0.5 of this resource will not be started, despite there is available 0.5 of the resource in total, because there is no single index that is free at least on 0.5.</p> <p>If non-integer is bigger than 1, than integer part is always satisfied as whole indices and rest is a part of another index. E.g. when you ask for 2.5 of an indexed resource, you will get 2 complete indices and one index allocated on 50%.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>In the current version, policy "compact!" is not allowed with non-integer amounts.</p> </div> <h3 id=resource-environment-variables>Resource environment variables<a class=headerlink href=#resource-environment-variables title="Permanent link">#</a></h3> <p>When a task that has resource requests is executed, the following variables are passed to it for each resource request named <code>&lt;NAME&gt;</code>:</p> <ul> <li><code>HQ_RESOURCE_REQUEST_&lt;NAME&gt;</code> contains the amount of requested resources.</li> <li><code>HQ_RESOURCE_VALUES_&lt;NAME&gt;</code> contains the specific resource values allocated for the task as a comma-separated list. This variable is only filled for an indexed resource pool. In case of non-integer amount, the partially allocated index is always the last index.</li> </ul> <p>The slash symbol (<code>/</code>) in resource name is normalized to underscore (<code>_</code>) when being used in the environment variable name.</p> <p>HQ also sets additional environment variables for various resources with special names:</p> <ul> <li>For the resource <code>gpus/nvidia</code>, HQ will set:<ul> <li><code>CUDA_VISIBLE_DEVICES</code> to the same value as <code>HQ_RESOURCE_VALUES_gpus_nvidia</code></li> <li><code>CUDA_DEVICE_ORDER</code> to <code>PCI_BUS_ID</code></li> </ul> </li> <li>For the resource <code>gpus/amd</code>, HQ will set:<ul> <li><code>ROCR_VISIBLE_DEVICES</code> to the same value as <code>HQ_RESOURCE_VALUES_gpus_amd</code></li> </ul> </li> </ul> <h2 id=resource-requests-and-job-arrays>Resource requests and job arrays<a class=headerlink href=#resource-requests-and-job-arrays title="Permanent link">#</a></h2> <p>Resource requests are applied to each task of job. For example, if you submit the following:</p> <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>submit<span class=w> </span>--cpus<span class=o>=</span><span class=m>2</span><span class=w> </span>--array<span class=o>=</span><span class=m>1</span>-10
</code></pre></div> <p>then each task will require two cores.</p> <h2 id=resource-variants>Resource variants<a class=headerlink href=#resource-variants title="Permanent link">#</a></h2> <p>A task may have attached more resource requests. There is no command line interface for this feature, but it can be configured through a <a href=../jobfile/ >Job Definition File</a>.</p> <hr> <div class=md-source-date> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 3, 2023</span> <br>Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 2, 2021</span> </small> </div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../arrays/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Task Arrays" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Task Arrays </div> </div> </a> <a href=../cresources/ class="md-footer__link md-footer__link--next" aria-label="Next: CPU Resources" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> CPU Resources </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["header.autohide", "navigation.instant", "navigation.top"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.e99e714c.min.js", "version": {"provider": "mike", "default": "stable"}}</script> <script src=../../assets/javascripts/bundle.bc35569b.min.js></script> </body> </html>