<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation of HyperQueue."><meta name=author content="Stanislav Böhm, Jakub Beránek"><link href=https://it4innovations.github.io/hyperqueue/stable/jobs/streaming/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-7.3.2"><title>Output Streaming - HyperQueue</title><link rel=stylesheet href=../../assets/stylesheets/main.24c991ad.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-TM8J8R5GJ9"),document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof location$&&location$.subscribe(function(t){gtag("config","G-TM8J8R5GJ9",{page_path:t.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-TM8J8R5GJ9"></script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=none data-md-color-accent=none> <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#redirecting-output-to-the-log class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=HyperQueue class="md-header__button md-logo" aria-label=HyperQueue data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> HyperQueue </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Output Streaming </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/It4innovations/hyperqueue/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=HyperQueue class="md-nav__button md-logo" aria-label=HyperQueue data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> HyperQueue </label> <div class=md-nav__source> <a href=https://github.com/It4innovations/hyperqueue/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../installation/ class=md-nav__link> Installation </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Getting Started <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting Started" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../quickstart/ class=md-nav__link> Quickstart </a> </li> <li class=md-nav__item> <a href=../../cheatsheet/ class=md-nav__link> Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Deployment <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Deployment data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../deployment/ class=md-nav__link> Architecture </a> </li> <li class=md-nav__item> <a href=../../deployment/server/ class=md-nav__link> Server </a> </li> <li class=md-nav__item> <a href=../../deployment/worker/ class=md-nav__link> Workers </a> </li> <li class=md-nav__item> <a href=../../deployment/allocation/ class=md-nav__link> Automatic Allocation </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5> Task computation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Task computation" data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Task computation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../jobs/ class=md-nav__link> Jobs and Tasks </a> </li> <li class=md-nav__item> <a href=../arrays/ class=md-nav__link> Task Arrays </a> </li> <li class=md-nav__item> <a href=../resources/ class=md-nav__link> Resources </a> </li> <li class=md-nav__item> <a href=../cresources/ class=md-nav__link> CPU Resources </a> </li> <li class=md-nav__item> <a href=../failure/ class=md-nav__link> Handling Failure </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Output Streaming <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Output Streaming </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#redirecting-output-to-the-log class=md-nav__link> Redirecting output to the log </a> <nav class=md-nav aria-label="Redirecting output to the log"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#partial-redirection class=md-nav__link> Partial redirection </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#guarantees class=md-nav__link> Guarantees </a> <nav class=md-nav aria-label=Guarantees> <ul class=md-nav__list> <li class=md-nav__item> <a href=#superseded-streams class=md-nav__link> Superseded streams </a> </li> <li class=md-nav__item> <a href=#current-limitations class=md-nav__link> Current limitations </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#inspecting-the-log-file class=md-nav__link> Inspecting the log file </a> <nav class=md-nav aria-label="Inspecting the log file"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#log-summary class=md-nav__link> Log summary </a> </li> <li class=md-nav__item> <a href=#printing-log-content class=md-nav__link> Printing log content </a> </li> <li class=md-nav__item> <a href=#log-metadata class=md-nav__link> Log metadata </a> </li> <li class=md-nav__item> <a href=#exporting-log class=md-nav__link> Exporting log </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../directives/ class=md-nav__link> Directives </a> </li> <li class=md-nav__item> <a href=../multinode/ class=md-nav__link> Multinode Tasks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> CLI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=CLI data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> CLI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/shortcuts/ class=md-nav__link> Shortcuts </a> </li> <li class=md-nav__item> <a href=../../cli/output-mode/ class=md-nav__link> Output mode </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> Python API <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Python API" data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Python API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../python/ class=md-nav__link> Getting started </a> </li> <li class=md-nav__item> <a href=../../python/client/ class=md-nav__link> Client </a> </li> <li class=md-nav__item> <a href=../../python/submit/ class=md-nav__link> Submitting jobs </a> </li> <li class=md-nav__item> <a href=../../python/dependencies/ class=md-nav__link> Dependencies </a> </li> <li class=md-nav__item> <a href=../../python/apidoc/ class=md-nav__link> API reference </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../events/ class=md-nav__link> Events </a> </li> <li class=md-nav__item> <a href=../../faq/ class=md-nav__link> FAQ </a> </li> <li class=md-nav__item> <a href=../../other-tools/ class=md-nav__link> Comparison With Other Tools </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#redirecting-output-to-the-log class=md-nav__link> Redirecting output to the log </a> <nav class=md-nav aria-label="Redirecting output to the log"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#partial-redirection class=md-nav__link> Partial redirection </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#guarantees class=md-nav__link> Guarantees </a> <nav class=md-nav aria-label=Guarantees> <ul class=md-nav__list> <li class=md-nav__item> <a href=#superseded-streams class=md-nav__link> Superseded streams </a> </li> <li class=md-nav__item> <a href=#current-limitations class=md-nav__link> Current limitations </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#inspecting-the-log-file class=md-nav__link> Inspecting the log file </a> <nav class=md-nav aria-label="Inspecting the log file"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#log-summary class=md-nav__link> Log summary </a> </li> <li class=md-nav__item> <a href=#printing-log-content class=md-nav__link> Printing log content </a> </li> <li class=md-nav__item> <a href=#log-metadata class=md-nav__link> Log metadata </a> </li> <li class=md-nav__item> <a href=#exporting-log class=md-nav__link> Exporting log </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/It4innovations/hyperqueue/blob/main/docs/jobs/streaming.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1>Output Streaming</h1> <p>Jobs containing <a href=../arrays/ >many tasks</a> will generate a large amount of <code>stdout</code> and <code>stderr</code> files, which can be problematic, especially on network-based shared filesystems, such as Lustre. For example, when you submit the following task array:</p> <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>submit<span class=w> </span>--array<span class=o>=</span><span class=m>1</span>-10000<span class=w> </span>my-computation.sh
</code></pre></div> <p><code>20000</code> files (<code>10000</code> for stdout and <code>10000</code> for stderr) will be created on the disk.</p> <p>To avoid this situation, HyperQueue can optionally stream the <code>stdout</code> and <code>stderr</code> output of all tasks of a job over a network to the server, which will continuously append it to a single file called the <strong>Log</strong>.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>In this section, we refer to <code>stdout</code> and <code>stderr</code> as <strong>channels</strong>.</p> </div> <p align=center> <img width=600 src=../../imgs/streaming.png> </p> <h2 id=redirecting-output-to-the-log>Redirecting output to the log<a class=headerlink href=#redirecting-output-to-the-log title="Permanent link">#</a></h2> <p>You can redirect the output of <code>stdout</code> and <code>stderr</code> to a log file and thus enable output streaming by passing a path to a filename where the log will be stored with the <code>--log</code> option:</p> <div class=highlight><pre><span></span><code>$ hq submit --log=&lt;log-path&gt; --array=1-10000 ...
</code></pre></div> <p>This command would cause the <code>stdout</code> and <code>stderr</code> of all <code>10000</code> tasks to be streamed into the server, which will write them to a single file specified in <code>&lt;log-path&gt;</code>. The streamed data is stored with additional metadata, which allows the resulting file to be filtered/sorted by tasks or output type (<code>stdout</code>/<code>stderr</code>).</p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>You can use selected <a href=../jobs/#placeholders>placeholders</a> inside the log path.</p> </div> <h3 id=partial-redirection>Partial redirection<a class=headerlink href=#partial-redirection title="Permanent link">#</a></h3> <p>By default, both <code>stdout</code> and <code>stderr</code> will be streamed if you specify <code>--log</code> and do not specify an explicit path for <code>stdout</code> and <code>stderr</code>. To stream only one of the channels, you can use the <code>--stdout</code>/<code>--stderr</code> options to redirect one of them to a file or to disable it completely.</p> <p>For example:</p> <div class=highlight><pre><span></span><code><span class=c1># Redirecting stdout into a file, streaming stderr into `my-log`</span>
$<span class=w> </span>hq<span class=w> </span>submit<span class=w> </span>--log<span class=o>=</span>my-log<span class=w> </span>--stdout<span class=o>=</span><span class=s2>&quot;stdout-%{TASK_ID}&quot;</span><span class=w> </span>...

<span class=c1># Streaming stdout into `my-log`, disabling stderr</span>
$<span class=w> </span>hq<span class=w> </span>submit<span class=w> </span>--log<span class=o>=</span>my-log<span class=w> </span>--stderr<span class=o>=</span>none<span class=w> </span>...
</code></pre></div> <h2 id=guarantees>Guarantees<a class=headerlink href=#guarantees title="Permanent link">#</a></h2> <p>HyperQueue provides the following guarantees regarding output streaming:</p> <ul> <li>When a task is <code>Finished</code> or <code>Failed</code>, then it is guaranteed* that its streamed output is fully flushed into the log file.</li> <li>When a task is <code>Canceled</code>, then its stream is not necessarily fully written into the log file at the moment it becomes canceled. Some parts of its output may be written later, but the stream will be eventually closed.</li> <li> <p>When a task is <code>Canceled</code> or its <a href=../jobs/#time-management>time limit</a> is reached, then the part of its stream that was buffered in the worker is dropped to avoid spending additional resources for this task.</p> <p>In practice, only output produced immediately before a task is canceled could be dropped, since output data is streamed to the server as soon as possible.</p> </li> </ul> <p>* If the streaming itself failed (e.g. because there was insufficient disk space for the log file), then the task will fail with an error prefixed with <code>"Streamer:"</code> and no further streaming guarantees will be upheld.</p> <h3 id=superseded-streams>Superseded streams<a class=headerlink href=#superseded-streams title="Permanent link">#</a></h3> <p>When a worker crashes while executing a task, the task will be <a href=../failure/#task-restart>restarted</a>. If output streaming is enabled and the task has already streamed some output data before it was restarted, invalid or duplicate output could appear in the log.</p> <p>To avoid mixing outputs from different executions of the same task, when a task is restarted, HyperQueue automatically marks all output streamed from previous runs of the task as superseded and ignores this output by default.</p> <h3 id=current-limitations>Current limitations<a class=headerlink href=#current-limitations title="Permanent link">#</a></h3> <p>The current version does not support streaming the output of multiple jobs into the same file. In other words, if you submit multiple jobs with the same log filename, like this:</p> <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>submit<span class=w> </span>--log<span class=o>=</span>my-log<span class=w> </span>...
$<span class=w> </span>hq<span class=w> </span>submit<span class=w> </span>--log<span class=o>=</span>my-log<span class=w> </span>...
</code></pre></div> <p>Then the log will contain data from a single job only, the other data will be overwritten.</p> <h2 id=inspecting-the-log-file>Inspecting the log file<a class=headerlink href=#inspecting-the-log-file title="Permanent link">#</a></h2> <p>HyperQueue lets you inspect the data stored inside the log file using various subcommands. All <code>log</code> subcommands have the following structure:</p> <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>log<span class=w> </span>&lt;log-file-path&gt;<span class=w> </span>&lt;subcommand&gt;<span class=w> </span>&lt;subcommand-args&gt;
</code></pre></div> <h3 id=log-summary>Log summary<a class=headerlink href=#log-summary title="Permanent link">#</a></h3> <p>You can display a summary of a log file using the <code>summary</code> subcommand: <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>log<span class=w> </span>&lt;log-file-path&gt;<span class=w> </span>summary
</code></pre></div></p> <h3 id=printing-log-content>Printing log content<a class=headerlink href=#printing-log-content title="Permanent link">#</a></h3> <p>If you want to simply print the (textual) content of the log file, without any associating metadata, you can use the <code>cat</code> subcommand:</p> <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>log<span class=w> </span>&lt;log-file-path&gt;<span class=w> </span>cat<span class=w> </span>&lt;stdout/stderr&gt;
</code></pre></div> <p>It will print the raw content of either <code>stdout</code> or <code>stderr</code>, ordered by task id. All outputs will be concatenated one after another. You can use this to process the streamed data e.g. by a postprocessing script.</p> <p>By default, this command will fail if there is an unfinished stream (i.e. when some task is still running and streaming data into the log). If you want to use <code>cat</code> even when the log is not finished yet, use the <code>--allow-unfinished</code> option.</p> <p>If you want to see the output of a specific task, you can use the <code>--task=&lt;task-id&gt;</code> option.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Superseded streams are completely ignored by the <code>cat</code> subcommand.</p> </div> <h3 id=log-metadata>Log metadata<a class=headerlink href=#log-metadata title="Permanent link">#</a></h3> <p>If you want to inspect the contents of the log, along with its inner metadata that shows which task and which channel has produced which part of the data, you can use the <code>show</code> subcommand:</p> <div class=highlight><pre><span></span><code>$<span class=w> </span>hq<span class=w> </span>log<span class=w> </span>&lt;log-file-path&gt;<span class=w> </span>show
</code></pre></div> <p>The output will have the form <code>X:Y&gt; DATA</code> where <code>X</code> is task id and <code>Y</code> is <code>0</code> for <code>stdout</code> channel and <code>1</code> for <code>stderr</code> channel.</p> <p>You can filter a specific channel with the <code>--channel=stdout/stderr</code> flag.</p> <p>By default, HQ does not show stream close metadata from streams that are empty (e.g. when a task did not produce any output on some channel). You can change that with the flag <code>--show-empty</code>.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Superseded streams are completely ignored by the <code>show</code> subcommand.</p> </div> <h3 id=exporting-log>Exporting log<a class=headerlink href=#exporting-log title="Permanent link">#</a></h3> <p>Log can be exported into JSON by the following command:</p> <div class=highlight><pre><span></span><code>$ hq log &lt;log-file-path&gt; export
</code></pre></div> <p>This prints the log file into a JSON format on standard output.</p> <hr> <div class=md-source-date> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 10, 2022</span> <br>Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 2, 2021</span> </small> </div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../failure/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Handling Failure" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Handling Failure </div> </div> </a> <a href=../directives/ class="md-footer__link md-footer__link--next" aria-label="Next: Directives" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Directives </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["header.autohide", "navigation.instant", "navigation.top"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.e99e714c.min.js", "version": {"provider": "mike", "default": "stable"}}</script> <script src=../../assets/javascripts/bundle.bc35569b.min.js></script> </body> </html>